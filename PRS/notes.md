## Operativna memorija
- Iskorišćenje memorije, veličina propusnog opsega
- `s`: veličina posla
    1. Model jednakih veličina (svi poslovi jednakih veličina)
    2. Sve veličine jednako verovatne (srednja veličina je `a`)
    3. Eksponencijalna raspodela
- `t`: vreme zadržavanja programa u memoriji
    1. `t = const`
    2. `t = f(s)`
- Monoprogramski sistem:
    - M = 1, normalizujemo
    - Prosečno iskorišćenje memorije: `(s1t1 + s2t2 + ...)/(t1 + t2 + ...)`
        - U slučaju `t = K * S`: $\overline{U} = \frac{\overline{S^2}}{\overline{S}}$
            - Ako je uniformna raspodela onda je $\overline{S} = a$, a $\overline{S^2} = \frac{1}{2a} \int_a^{2a} S^2 \cdot ds = \frac{s^3}{3}|_a^{2a} = \frac{4a^2}{3}$
            - Ovo znači da je maksimalno iskorišćenje u ovakvom sistemu 2/3
- Statičke particije:
    - Normalizujemo po veličini veće particije
    - Mali programi su oni koji mogu u malu particiju
    - Jednako verovatne veličine programa:
        - `x = xs/xb`, normalizujemo po veličini veće particije
        - Razmatramo za `t = const` i ako bafer poslova nikad nije prazan
        - $\overline{U_{bs}} = \frac{\frac{0 + x}{2} + \frac{x + 1}{2}}{1 + x}$
        - $\overline{U_{ss}} = \frac{\frac{0 + x}{2} + \frac{0 + x}{2}}{1 + x}$
        - $\overline{U_{be}} = \frac{0 + \frac{x + 1}{2}}{1 + x}$
        - SE ne može da se desi sa ovom pretpostavkom
        - Promene su trenutne i dešavaju se samo u diskretnim trenucima
        - $\overline{U} = p_{bs} \cdot U_{bs} + ...$
        - Gledaju se prelazi između stanja za određivanje verovatnoće
        - $p_s = x, p_b = 1 - x$, za svaki prelaz verovatnoća je proizvod verovatnoća veličina tih programa, obratiti pažnju na prelaze iz BE
    - Markovljevi lanci:
        - Za svako stanje mašine verovatnoća da se nađe u tom stanju jeste verovatnoća susednih stanja pomnožena sa verovatnoćom prelaza iz tog stanja
- Knuth-ov model nevirtuelnih dinamičkih particija:
    - B: blok, H: hole
    - Procena broja rupa i broja blokova, iskorišćenje memorije
    - Rupe se spajaju u jednu
    - `n`: srednji broj rupa, `m`: srednji broj blokova
    - Gledamo kako se pri alokaciji i dealokaciji menjaju `m` i `n`
    - `a`: broj blokova samih između rupa, `b`: na početku niza blokova, `c`: na kraju niza blokova, `d`: u sredini niza blokova
        - $b = c$
        - $2n = 2a + b + c$
        - $p$: verovatnoća savršenog popunjavanja rupe pri alokaciji
        - $\Delta n = p_{dealloc} [ p_d - p_a ] + p_{alloc} [ -p ] = p_{dealloc} \frac{d - a}{m} - p_{alloc} p$
        - Alociranje i dealociranje jednakoverovatno: $\Delta n = \frac{d - a}{m} - p = 0$
        - $d = a + pm \implies m = 2a + b + c + pm \implies m (1 - p) = 2n \implies n = \frac{m (1 - p)}{2}$
    - Iskorišćenje memorije: $U = m \cdot \overline{S}$
        - $c = \frac{\overline{H}}{\overline{s}}$, odnos veličine rupa i programa
        $1 = m\overline{S} + n\overline{H} = m(\overline{S} + \frac{n}{m}c\overline{S}) = U (1 + \frac{c}{2})$
            - $U = \frac{2}{2 + c}$
- Betteridge model:
    - Eksponencijalna zavisnost vremena zadržavanja programa od veličine
    - Programi ne mogu da se završe u isto vreme
    - Iz B možemo preći u ES ili SE ako nam dođu S pa B, svejedno
    - U svakom stanju izračunamo iskorišćenje i verovatnoću stanja, na osnovu toga dobijemo ukupno iskorišćenje
    - Broj stanja automata raste sa brojem particija, $fib_{2m}-1$
    - Imamo asimptotu u iskorišćenju i sa povećavanjem broja particija, čak i kada dozvolimo realokaciju
- Statičke stranice:
    - Kao Betteridge model, ali uračunavamo internu fragmentaciju u kojoj se u proseku baca pola stranice
    - $n_{avg}$: prosečan stepen multiprogramiranja
    - $x$: veličina stranice
    - Škart: $n_{avg} \cdot \frac{1}{2} x$
- Virtuelna memorija:
    - $k$: veličina ulaza u PMT
    - Škart: $n_{avg} \cdot \frac{1}{2} x + M_{pmt}$
    - $M_{pmt} = M \cdot \frac{k}{k + x} \approx M \cdot \frac{k}{x}$
    - $W \geq 2 \sqrt{M \frac{k}{x} \frac{n_{avg}}{2} x} = \sqrt{2M k n_{avg}}$ (AG nejednakost)
        - $x_{opt} = \sqrt{\frac{2Mk}{2_{avg}}}$
    - Dodajemo $\frac{1}{R}$, verovatnoću da je poslednja stranica programa u memoriji, kao činilac u delu jednačine sa internom fragmentacijom

## Performanse diskova
- Formula: $T = T_{am} + T_{rd} + T_{dt}$ gde $T_{rd} = \frac{T_{rot}}{2}$, $T_{dt} = \frac{T_{rot}}{12}$ i $T_{rot} = \frac{1}{v_{rot}}$
- $T_{am}$ ima uračunate verovatnoće da se prelazi sa jednog mesta na drugo koje se množe sa vremenima pristupa od jednog mesta do drugog
- $t_{12} = \frac{1}{n_{c1}} \int_{s_{c1}}^{e_{c1}} \frac{1}{n_{c2}} \int_{s_{c2}}^{e_{c2}} t(x, y) dx dy$
- $t_{11} = \frac{2}{n_c^2} \int_0^{n_c} (n_c - x) t(x) dx$
- $T_{rot}$ samo zavisi od brzine rotacije
- Ako ti daju grafik, odrediš jednačine pravih i podeliš $T_{am}$ na više integrala
    - Mogu da ti daju i da sam nacrtaš grafik linearnom aproksimacijom na osnovu maksimalnog i minimalnog vremena kretanja
- Ako ne čitamo zapis sa diska onda $T_{dt} = 0$

## Serveri
- Oznake:
    - Srednje vreme zadržavanja: $\overline{S}$
        - Označava prosečno vreme koliko jednom zahtevu treba da se obradi
    - Frekvencija dolaska poslova: $\lambda$
    - Brzina jednog procesora: $\mu$
    - Statičke verovatnoće stanja: $p_i$
    - Uvedena smena, generalno $\frac{\lambda}{\mu}$: $\rho$
        - Paziti se slučaja kada je $\rho = 1$ jer može da dođe do deljenja nulom
    - Vreme odziva sistema: $T$
        - Vreme prolaska kroz ceo sistem
    - Prosečan broj poslova u sistemu: $J$
    - Protok kroz red za čekanje: $X$
- Poasonov proces:
    - Svi zahtevi pristižu nezavisno
    - Nijedan zahtev ne može da pristigne u isto vreme
- Sistem opisujemo automatom stanja gde su stanja broj poslova (balansni graf)
    - Ne postoje grane tipa 0 -> 2 jer ne mogu dva posla da pristignu u isto vreme
    - Statičke verovatnoće stanja se sabiraju do 1
    - Balansne jednačine: množimo statičku verovatnoću stanja sa verovatnoćom odliva i izjednačavamo sa zbirom proizvoda svih ostalih statičkih verovatnoća stanja i njihovih verovatnoća priliva u to stanje
    - Litlova formula: $T = \frac{J}{X}$
    - $J = \sum i p_i$
    - Zakon iskorišćenja: $U = Xs$
- Redovi:
    - Geometrijski: $1 + \rho + \rho^2 + ... = \frac{1}{1 - \rho}$
        - Konvergira ako je $\rho < 1$
    - Konačni geometrijski: $1 + \rho + \rho^2 + ... + \rho^n = \frac{1 - \rho^{n + 1}}{1 - \rho}$
    - Potencijalni red: $1 + 2\rho + 3\rho^2 + ... = \frac{1}{(1 - \rho)^2}$
- Prosečan broj poslova u sistemu sa jednim procesorom (M/M/1): $J = \frac{\rho}{1 - \rho}$
    - M/M/2: $J = \frac{2\rho}{1 - \rho^2}$
- Burke je dokazao da ako u sistem ulazi Poasonov proces sa $X$, na izlazu je isto $X$
    - Kobayashi je dokazao da po granama takođe ide $X$
- Ciklički sistemi:
    - Sistem će uvek biti stabilan
- Gordon-Newell metoda:
    - Napravimo matricu verovatnoća da se sa jednog stanja prelazi na drugo, transponujemo je i napravimo matricu $D = \mu_1 x_1, \mu_2 x_2, ...$ i iz toga treba da se dobije $0 = (P^T - I) D$, i onda možemo izračunati statičke verovatnoće stanja
- Bjuzenova metoda:
    - Napravimo matricu gde levo ide stepen multiprogramiranja a gore broj servera, prva kolona su sve nule a prvi red sve kečevi, i zatim se svaka ćelija pravi kao levo + gore * $x_i$
    - $U_j(N) = x_j^1 \cdot \frac{G(N-1)}{G(N)}$
    - Onaj trougaoni način za računanje $J$
